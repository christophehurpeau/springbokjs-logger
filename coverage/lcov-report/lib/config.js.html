<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for lib/config.js</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" href="../prettify.css" />
    <link rel="stylesheet" href="../base.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type='text/css'>
        .coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class='wrapper'>
  <div class='pad1'>
    <h1>
      <a href="../index.html">all files</a> / <a href="index.html">lib/</a> config.js
    </h1>
    <div class='clearfix'>
      <div class='fl pad1y space-right2'>
        <span class="strong">28.57% </span>
        <span class="quiet">Statements</span>
        <span class='fraction'>16/56</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">4.17% </span>
        <span class="quiet">Branches</span>
        <span class='fraction'>1/24</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">0% </span>
        <span class="quiet">Functions</span>
        <span class='fraction'>0/5</span>
      </div>
      <div class='fl pad1y space-right2'>
        <span class="strong">30.19% </span>
        <span class="quiet">Lines</span>
        <span class='fraction'>16/53</span>
      </div>
    </div>
  </div>
  <div class='status-line low'></div>
<pre><table class="coverage">
<tr><td class="line-count quiet">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115</td><td class="line-coverage quiet"><span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1×</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">'use strict';
&nbsp;
Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.configure = configure;
exports.addGlobalProcessor = addGlobalProcessor;
exports.addGlobalHandler = addGlobalHandler;
&nbsp;
var _minimatch = require('minimatch');
&nbsp;
<span class="missing-if-branch" title="else path not taken" >E</span>if (!global.__NIGHTINGALE_CONFIG) {
    global.__NIGHTINGALE_CONFIG = [];
    global.__NIGHTINGALE_GLOBAL_PROCESSORS = [];
    global.__NIGHTINGALE_GLOBAL_HANDLERS = [];
    global.__NIGHTINGALE_LOGGER_MAP_CACHE = new Map();
    global.__NIGHTINGALE_CONFIG_DEFAULT = {
        handlers: [],
        processors: []
    };
}
&nbsp;
/**
 * @function
*/<span class="fstat-no" title="function not covered" >function clearCache() {</span>
<span class="cstat-no" title="statement not covered" >    global.__NIGHTINGALE_LOGGER_MAP_CACHE.clear();</span>
}
&nbsp;
/**
 * @function
 * @param config
*/<span class="fstat-no" title="function not covered" >function configure(config) {</span>
<span class="cstat-no" title="statement not covered" >    global.__NIGHTINGALE_CONFIG = [];</span>
<span class="cstat-no" title="statement not covered" >    global.__NIGHTINGALE_CONFIG_DEFAULT = null;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    config.reverse().forEach(c =&gt; {</span>
<span class="cstat-no" title="statement not covered" >        if (c.pattern) {</span>
<span class="cstat-no" title="statement not covered" >            if (c.patterns) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('Cannot have pattern and patterns for the same config');</span>
            }
<span class="cstat-no" title="statement not covered" >            c.patterns = c.pattern;</span>
<span class="cstat-no" title="statement not covered" >            delete c.pattern;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (c.handler) {</span>
<span class="cstat-no" title="statement not covered" >            if (c.handlers) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('Cannot have handler and handlers for the same config');</span>
            }
<span class="cstat-no" title="statement not covered" >            c.handlers = c.handler;</span>
<span class="cstat-no" title="statement not covered" >            delete c.handler;</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        if (c.patterns) {</span>
<span class="cstat-no" title="statement not covered" >            c.minimatchPatterns = c.patterns.map(pattern =&gt; <span class="cstat-no" title="statement not covered" >new _minimatch.Minimatch(pattern))</span>;</span>
<span class="cstat-no" title="statement not covered" >            global.__NIGHTINGALE_CONFIG.push(c);</span>
        } else {
<span class="cstat-no" title="statement not covered" >            if (global.__NIGHTINGALE_CONFIG_DEFAULT) {</span>
<span class="cstat-no" title="statement not covered" >                throw new Error('Config cannot contains more than 1 default declaration');</span>
            }
&nbsp;
<span class="cstat-no" title="statement not covered" >            global.__NIGHTINGALE_CONFIG_DEFAULT = c;</span>
        }
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (!global.__NIGHTINGALE_CONFIG_DEFAULT) {</span>
<span class="cstat-no" title="statement not covered" >        global.__NIGHTINGALE_CONFIG_DEFAULT = {</span>
            handlers: [],
            processors: []
        };
    }
}
&nbsp;
/**
 * @function
 * @param processor
*/<span class="fstat-no" title="function not covered" >function addGlobalProcessor(processor) {</span>
<span class="cstat-no" title="statement not covered" >    clearCache();</span>
<span class="cstat-no" title="statement not covered" >    global.__NIGHTINGALE_GLOBAL_PROCESSORS.push(processor);</span>
}
&nbsp;
/**
 * @function
 * @param handler
*/<span class="fstat-no" title="function not covered" >function addGlobalHandler(handler) {</span>
<span class="cstat-no" title="statement not covered" >    clearCache();</span>
<span class="cstat-no" title="statement not covered" >    global.__NIGHTINGALE_GLOBAL_HANDLERS.push(handler);</span>
}
&nbsp;
global.__NIGHTINGALE_GET_CONFIG_FOR_LOGGER = /**
                                              * @function
                                              * @param key
                                             */<span class="fstat-no" title="function not covered" >function (key) {</span>
<span class="cstat-no" title="statement not covered" >    const globalProcessors = global.__NIGHTINGALE_GLOBAL_PROCESSORS;</span>
<span class="cstat-no" title="statement not covered" >    const globalHandlers = global.__NIGHTINGALE_GLOBAL_HANDLERS;</span>
<span class="cstat-no" title="statement not covered" >    const globalCache = global.__NIGHTINGALE_LOGGER_MAP_CACHE;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (globalCache.has(key)) {</span>
<span class="cstat-no" title="statement not covered" >        return globalCache.get(key);</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    let value = global.__NIGHTINGALE_CONFIG.find(c =&gt; <span class="cstat-no" title="statement not covered" >c.minimatchPatterns.some(p =&gt; <span class="cstat-no" title="statement not covered" >p.match(key))</span>)</span>;</span>
<span class="cstat-no" title="statement not covered" >    if (!value) {</span>
<span class="cstat-no" title="statement not covered" >        value = global.__NIGHTINGALE_CONFIG_DEFAULT;</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    let loggerConfig = {</span>
        patterns: value.patterns,
        handlers: value.handlers ? globalHandlers.concat(value.handlers) : globalHandlers,
        processors: value.processors ? globalProcessors.concat(value.processors) : globalProcessors
    };
&nbsp;
<span class="cstat-no" title="statement not covered" >    globalCache.set(key, loggerConfig);</span>
<span class="cstat-no" title="statement not covered" >    return loggerConfig;</span>
};
//# sourceMappingURL=config.js.map</pre></td></tr>
</table></pre>
<div class='push'></div><!-- for sticky footer -->
</div><!-- /wrapper -->
<div class='footer quiet pad2 space-top1 center small'>
  Code coverage
  generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Mon May 02 2016 14:55:08 GMT+0000 (UTC)
</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
