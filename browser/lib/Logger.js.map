{"version":3,"sources":["../../src/Logger.js"],"names":[],"mappings":"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","file":"Logger.js","sourcesContent":["import util from 'util';\nimport LogLevel from './LogLevel';\n\n/**\n * Interface that allows you to log records.\n * This records are treated by handlers\n */\nexport default class Logger {\n    /**\n     * Create a new Logger\n     *\n     * @param {Handler[]} handlers\n     */\n    constructor(handlers) {\n        this.handlers = handlers;\n\n        Object.getOwnPropertyNames(Logger.prototype).forEach((key) => {\n            if (key === 'constructor') {\n                return;\n            }\n\n            this[key] = Logger.prototype[key].bind(this);\n        });\n    }\n\n    /**\n     * Write a message\n     *\n     * @param {string} message\n     * @param {string} logLevel\n     * @return {Logger}\n     */\n    write(message, logLevel) {\n        this.output.write(message, logLevel);\n        return this;\n    }\n\n    /**\n     * Handle a record\n     *\n     * Use this only if you know what you are doing.\n     *\n     * @param {Object} record\n     */\n    addRecord(record) {\n        for (let i = 0, length = this.handlers.length; i < length; i++) {\n            let handler = this.handlers[i];\n            if (handler.handle(record) === false) {\n                return;\n            }\n        }\n    }\n\n    /**\n     * Log a message\n     *\n     * @param {string} message\n     * @param {Object} context\n     * @param {int} [logLevel]\n     * @param {Object} [options]\n     * @return {Logger}\n     */\n    log(message, context, logLevel = LogLevel.INFO, options = undefined) {\n        let record = {\n            level: logLevel,\n            prefix: this._prefix,\n            datetime: new Date(),\n            message: message,\n            context: context,\n            extra: {},\n        };\n\n        if (options) {\n            record = Object.assign(options, record);\n        }\n\n        this.addRecord(record);\n        return this;\n    }\n\n    /**\n     * Set the logger prefix\n     *\n     * @param {string} prefix\n     * @param {*} [styles]\n     */\n    setPrefix(prefix, styles) {\n        this._prefix = prefix;\n    }\n\n    /**\n     * Log an debug message\n     *\n     * @param {string} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    debug(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.DEBUG, { contextStyles });\n    }\n\n    /**\n     * Log an info message\n     *\n     * @param {string} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    info(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.INFO, { contextStyles });\n    }\n\n    /**\n     * Log an warn message\n     *\n     * @param {string} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    warn(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.WARN, { contextStyles });\n    }\n\n    /**\n     * Log an error message\n     *\n     * @param {string|Error} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    error(message, context, contextStyles) {\n        message = message.stack || message.message || message;\n        return this.log(message, context, LogLevel.ERROR, { contextStyles });\n    }\n\n    /**\n     * Log an alert message\n     *\n     * @param {string} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    alert(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.ALERT, { contextStyles });\n    }\n\n    /**\n     * Log an fatal message\n     *\n     * @param {string} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    fatal(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.FATAL, { contextStyles });\n    }\n\n    /**\n     * Log an inspected value\n     *\n     * @param {*} value\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    inspectValue(value, context, contextStyles) {\n        // Note: inspect is a special function for node:\n        // https://github.com/nodejs/node/blob/a1bda1b4deb08dfb3e06cb778f0db40023b18318/lib/util.js#L210\n        value = util.inspect(value, { depth: 6 });\n        return this.log(value, context, LogLevel.DEBUG, { contextStyles, styles: ['gray'] });\n    }\n\n    /**\n     * Log an debugged var\n     *\n     * @param {string} varName\n     * @param {*} varValue\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    inspectVar(varName, varValue, context, contextStyles) {\n        varValue = util.inspect(varValue, { depth: 6 });\n        return this.log(`${varName} = ${varValue}`, context, LogLevel.DEBUG, { contextStyles, styles: ['cyan'] });\n    }\n\n    /**\n     * Log an sucess message\n     *\n     * @param {string} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    success(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.INFO, {\n            contextStyles,\n            symbol: 'âœ”',\n            styles: ['green', 'bold'],\n        });\n    }\n\n    /**\n     * Stores current time in milliseconds\n     * in the timers map\n     *\n     * @param {string} name timer name\n     */\n    time(name) {\n        if (name) {\n            if (!this._timers) {\n                this._timers = {};\n            }\n\n            return this._timers[name] = Date.now();\n        }\n\n        return Date.now();\n    }\n\n    /**\n    * Finds difference between when this method\n    * was called and when the respective time method\n    * was called, then logs out the difference\n    * and deletes the original record\n    *\n    * @param {number=} time return of previous call to time()\n    * @param {string} name timer name\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n    */\n    timeEnd(time, name, context, contextStyles) {\n        const now = Date.now();\n\n        if (typeof time !== 'number') {\n            contextStyles = context;\n            context = name;\n            name = time;\n\n            if (!this._timers || !this._timers[name]) {\n                return;\n            }\n\n            time = this._timers[name];\n            delete this._timers[name];\n        }\n\n        const diffTime = now - time;\n        const seconds = diffTime > 1000 && Math.floor(diffTime / 1000);\n        const ms = diffTime - seconds * 1000;\n\n        const message = `${name ? `${name}: ` : ''}${seconds ? `${seconds}s and ` : ''}${ms}ms`;\n        this.log(message, context, LogLevel.INFO, { contextStyles });\n    }\n\n    /**\n     * Log an enter in a function\n     *\n     * @example\n     * class A {\n     *   method(arg1) {\n     *     logger.enter(method, { arg1 });\n     *     // Do your stuff\n     *   }\n     * }\n     *\n     * @param {Function} fn\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    enter(fn, context, contextStyles) {\n        return this.log(`enter ${fn.name}`, context, LogLevel.DEBUG, { contextStyles });\n    }\n\n    /**\n     * Log an exit in a function\n     *\n     * @example\n     * const logger = new ConsoleLogger('myNamespace.A');\n     * class A {\n     *   method(arg1) {\n     *     // Do your stuff\n     *     logger.exit(method, { arg1 });\n     *   }\n     * }\n     *\n     *\n     * @param {Function} fn\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    exit(fn, context, contextStyles) {\n        return this.log(`exit ${fn.name}`, context, LogLevel.DEBUG, { contextStyles });\n    }\n\n    /**\n     * Wrap around a function to log enter and exit of a function\n     *\n     * @example\n     * const logger = new ConsoleLogger('myNamespace.A');\n     * class A {\n     *   method() {\n     *     logger.wrap(method, () => {\n     *       // Do your stuff\n     *     });\n     *   }\n     * }\n     *\n     * @param {Function} fn\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @param {Function} callback\n     */\n    wrap(fn, context, contextStyles, callback) {\n        if (typeof context === 'function') {\n            callback = context;\n            context = undefined;\n        } else if (typeof contextStyles === 'function') {\n            callback = contextStyles;\n            contextStyles = undefined;\n        }\n\n        this.enter(fn, context, contextStyles);\n        callback();\n        this.exit(fn);\n    }\n}\n"]}