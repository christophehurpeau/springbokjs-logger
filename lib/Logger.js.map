{"version":3,"sources":["../src/Logger.js"],"names":[],"mappings":"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","file":"Logger.js","sourcesContent":["import util from 'util';\nimport LogLevel from './LogLevel';\n\n/**\n * Interface that allows you to log records.\n * This records are treated by handlers\n */\nexport default class Logger {\n    /**\n     * Create a new Logger\n     *\n     * @param {Handler[]} handlers\n     */\n    constructor(handlers) {\n        this.handlers = handlers;\n\n        Object.getOwnPropertyNames(Logger.prototype).forEach((key) => {\n            if (key === 'constructor') {\n                return;\n            }\n\n            this[key] = Logger.prototype[key].bind(this);\n        });\n    }\n\n    /**\n     * Write a message\n     *\n     * @param {String} message\n     * @param {String} logLevel\n     * @return {Logger}\n     */\n    write(message, logLevel) {\n        this.output.write(message, logLevel);\n        return this;\n    }\n\n    /**\n     * Handle a record\n     *\n     * Use this only if you know what you are doing.\n     *\n     * @param {Object} record\n     */\n    addRecord(record) {\n        for (let i = 0, length = this.handlers.length; i < length; i++) {\n            let handler = this.handlers[i];\n            if (handler.handle(record) === false) {\n                return;\n            }\n        }\n    }\n\n    /**\n     * Log a message\n     *\n     * @param {String} message\n     * @param {Object} context\n     * @param {int} [logLevel]\n     * @param {Object} [options]\n     * @return {Logger}\n     */\n    log(message, context, logLevel = LogLevel.INFO, options = undefined) {\n        let record = {\n            level: logLevel,\n            prefix: this._prefix,\n            datetime: new Date(),\n            message: message,\n            context: context,\n            extra: {},\n        };\n\n        if (options) {\n            record = Object.assign(options, record);\n        }\n\n        this.addRecord(record);\n        return this;\n    }\n\n    /**\n     * Set the logger prefix\n     *\n     * @param {String} prefix\n     * @param {*} [styles]\n     */\n    setPrefix(prefix, styles) {\n        this._prefix = prefix;\n    }\n\n    /**\n     * Log an debug message\n     *\n     * @param {String} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    debug(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.DEBUG, { contextStyles });\n    }\n\n    /**\n     * Log an info message\n     *\n     * @param {String} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    info(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.INFO, { contextStyles });\n    }\n\n    /**\n     * Log an warn message\n     *\n     * @param {String} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    warn(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.WARN, { contextStyles });\n    }\n\n    /**\n     * Log an error message\n     *\n     * @param {String|Error} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    error(message, context, contextStyles) {\n        message = message.stack || message.message || message;\n        return this.log(message, context, LogLevel.ERROR, { contextStyles });\n    }\n\n    /**\n     * Log an alert message\n     *\n     * @param {String} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    alert(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.ALERT, { contextStyles });\n    }\n\n    /**\n     * Log an fatal message\n     *\n     * @param {String} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    fatal(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.FATAL, { contextStyles });\n    }\n\n    /**\n     * Log an inspected value\n     *\n     * @param {*} value\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    inspectValue(value, context, contextStyles) {\n        // Note: inspect is a special function for node:\n        // https://github.com/nodejs/node/blob/a1bda1b4deb08dfb3e06cb778f0db40023b18318/lib/util.js#L210\n        value = util.inspect(value, { depth: 6 });\n        return this.log(value, context, LogLevel.DEBUG, { contextStyles, styles: ['gray'] });\n    }\n\n    /**\n     * Log an debugged var\n     *\n     * @param {String} varName\n     * @param {*} varValue\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    inspectVar(varName, varValue, context, contextStyles) {\n        varValue = util.inspect(varValue, { depth: 6 });\n        return this.log(varName + ' = ' + varValue, context, LogLevel.DEBUG, { contextStyles, styles: ['cyan'] });\n    }\n\n    /**\n     * Log an sucess message\n     *\n     * @param {String} message\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n     * @return {Logger}\n     */\n    success(message, context, contextStyles) {\n        return this.log(message, context, LogLevel.INFO, {\n            contextStyles,\n            symbol: 'âœ”',\n            styles: ['green', 'bold'],\n        });\n    }\n\n    /**\n     * Stores current time in milliseconds\n     * in the timers map\n     *\n     * @param {string} name timer name\n     */\n    time(name) {\n        if (name) {\n            if (!this._timers) {\n                this._timers = {};\n            }\n\n            return this._timers[name] = Date.now();\n        }\n\n        return Date.now();\n    }\n\n    /**\n    * Finds difference between when this method\n    * was called and when the respective time method\n    * was called, then logs out the difference\n    * and deletes the original record\n    *\n    * @param {Number=} time return of previous call to time()\n    * @param {string} name timer name\n     * @param {Object} [context]\n     * @param {Object} [contextStyles]\n    */\n    timeEnd(time, name, context, contextStyles) {\n        const now = Date.now();\n\n        if (typeof time !== 'number') {\n            contextStyles = context;\n            context = name;\n            name = time;\n\n            if (!this._timers || !this._timers[name]) {\n                return;\n            }\n\n            time = this._timers[name];\n            delete this._timers[name];\n        }\n\n        const diffTime = now - time;\n        const seconds = diffTime > 1000 && Math.floor(diffTime / 1000);\n        const ms = diffTime - seconds * 1000;\n\n        const message = (name ? name + ': ' : '') + (seconds ? seconds + 's and ' : '') + ms + 'ms';\n        this.log(message, context, LogLevel.INFO, { contextStyles });\n    }\n}\n"]}